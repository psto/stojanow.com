---
import { Picture } from "@astrojs/image/components";
import ExternalLink from "~/components/ExternalLink.astro";
import type { CollectionEntry } from "astro:content";
import { formatDate } from "~/utils";

type Props = {
  note: CollectionEntry<"notes">;
};

const { note } = Astro.props;
const imageAlt = note.data.imageAlt || "";
---

<header>
  <div class="content flex py-2">
    {
      note.data.image && (
        <div class="flex-1">
          <ExternalLink
            ariaLabel="Amazon smile book link"
            href={note.data.amazon}
          >
            <Picture
              src={import(`../images/notes/${note.data.image}.jpg`)}
              alt={imageAlt}
              widths={[100, 200, 300]}
              sizes="(max-width: 300px)"
              aspectRatio="3:4"
              loading="eager"
              formats={["avif", "webp"]}
              class="mr-4 rounded border-2 border-gray-200 object-fill dark:border-gray-600"
            />
          </ExternalLink>
        </div>
      )
    }
    <div class="item-body flex-1 px-2">
      <h2 class="p-name mb-4 text-center md:text-4xl lg:mb-8">
        {note.data.title}
      </h2>
    </div>
  </div>
  <div>
    <small>
      Date read:
      <time datetime={note.data.dateRead.toString()} class="italic">
        {formatDate(note.data.dateRead)}
      </time>
      <br />
      Check out <ExternalLink href={note.data.amazon}>Amazon</ExternalLink> for more
      details and reviews.
    </small>
    <p>{note.data.description}</p>
  </div>

  <hr />
</header>
